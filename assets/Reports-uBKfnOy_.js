import{j as i,S as h,B as s,m as a,R as g,C as r,a as o,s as c}from"./index-DvYlsgoa.js";import{E as l}from"./index-FdUC1R5x.js";import{u as k}from"./financeStore-DbLMuwj4.js";import{e as C}from"./export-cwhyOQjn.js";import{D as b}from"./index-BQmgfC5F.js";import{F as I}from"./Table-7vnEQdqH.js";import"./dayjs.min-BfZd7ylZ.js";import"./index-Cew7-v5w.js";function O(){const{records:n}=k(),d=()=>{const e=n.map(t=>({日期:t.date,类型:t.type==="income"?"收入":"支出",类别:t.category,描述:t.description,金额:t.amount}));C(e,[{title:"日期",dataIndex:"日期"},{title:"类型",dataIndex:"类型"},{title:"类别",dataIndex:"类别"},{title:"描述",dataIndex:"描述"},{title:"金额",dataIndex:"金额",render:t=>String(t)}],"财务报表"),c.success("导出成功")},m=()=>{window.print(),c.info("请使用浏览器打印功能保存为PDF")},x=n.filter(e=>e.type==="income").reduce((e,t)=>(e[t.category]=(e[t.category]||0)+t.amount,e),{}),p=n.filter(e=>e.type==="expense").reduce((e,t)=>(e[t.category]=(e[t.category]||0)+t.amount,e),{}),u={title:{text:"收入构成",left:"center"},tooltip:{trigger:"item",formatter:"{b}: ¥{c} ({d}%)"},series:[{type:"pie",radius:["40%","70%"],data:Object.entries(x).map(([e,t])=>({name:e,value:t}))}]},y={title:{text:"支出构成",left:"center"},tooltip:{trigger:"item",formatter:"{b}: ¥{c} ({d}%)"},series:[{type:"pie",radius:["40%","70%"],data:Object.entries(p).map(([e,t])=>({name:e,value:t}))}]},f=[{key:"1",item:"总收入",amount:n.filter(e=>e.type==="income").reduce((e,t)=>e+t.amount,0)},{key:"2",item:"总支出",amount:n.filter(e=>e.type==="expense").reduce((e,t)=>e+t.amount,0)},{key:"3",item:"净利润",amount:n.filter(e=>e.type==="income").reduce((e,t)=>e+t.amount,0)-n.filter(e=>e.type==="expense").reduce((e,t)=>e+t.amount,0)}],j=[{title:"项目",dataIndex:"item",key:"item"},{title:"金额",dataIndex:"amount",key:"amount",render:e=>`¥${e.toLocaleString()}`}];return i.jsxs("div",{children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsx("h2",{className:"text-xl font-bold",children:"报表中心"}),i.jsxs(h,{children:[i.jsx(b.RangePicker,{}),i.jsx(s,{icon:i.jsx(a,{}),onClick:d,children:"导出Excel"}),i.jsx(s,{icon:i.jsx(a,{}),onClick:m,children:"导出PDF"})]})]}),i.jsxs(g,{gutter:[16,16],children:[i.jsx(r,{xs:24,lg:12,children:i.jsx(o,{title:"收入分析",children:i.jsx(l,{option:u,style:{height:300}})})}),i.jsx(r,{xs:24,lg:12,children:i.jsx(o,{title:"支出分析",children:i.jsx(l,{option:y,style:{height:300}})})})]}),i.jsx(o,{title:"财务摘要",className:"mt-4",children:i.jsx(I,{columns:j,dataSource:f,pagination:!1})})]})}export{O as default};
