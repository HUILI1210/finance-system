import{r as u,I as h,_ as g,j as t,R as d,C as s,a,b as F,c as T,d as U,e as k,T as O}from"./index-DvYlsgoa.js";import{E as f}from"./index-FdUC1R5x.js";import{u as H}from"./financeStore-DbLMuwj4.js";import{u as W}from"./salaryStore-D3BodqG6.js";import{u as _}from"./bankStore-Br0JiNhk.js";import{u as K}from"./accountsStore-DK9nsyQx.js";import{u as q}from"./invoiceStore-DR7B55lf.js";import{S as i}from"./index-BHsiPuWj.js";import{L as z}from"./index-D9UsXoPj.js";import{F as G}from"./Table-7vnEQdqH.js";import"./index-Cew7-v5w.js";var J={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M193 796c0 17.7 14.3 32 32 32h574c17.7 0 32-14.3 32-32V563c0-176.2-142.8-319-319-319S193 386.8 193 563v233zm72-233c0-136.4 110.6-247 247-247s247 110.6 247 247v193H404V585c0-5.5-4.5-10-10-10h-44c-5.5 0-10 4.5-10 10v171h-75V563zm-48.1-252.5l39.6-39.6c3.1-3.1 3.1-8.2 0-11.3l-67.9-67.9a8.03 8.03 0 00-11.3 0l-39.6 39.6a8.03 8.03 0 000 11.3l67.9 67.9c3.1 3.1 8.1 3.1 11.3 0zm669.6-79.2l-39.6-39.6a8.03 8.03 0 00-11.3 0l-67.9 67.9a8.03 8.03 0 000 11.3l39.6 39.6c3.1 3.1 8.2 3.1 11.3 0l67.9-67.9c3.1-3.2 3.1-8.2 0-11.3zM832 892H192c-17.7 0-32 14.3-32 32v24c0 4.4 3.6 8 8 8h688c4.4 0 8-3.6 8-8v-24c0-17.7-14.3-32-32-32zM484 180h56c4.4 0 8-3.6 8-8V76c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v96c0 4.4 3.6 8 8 8z"}}]},name:"alert",theme:"outlined"},P=function(o,c){return u.createElement(h,g({},o,{ref:c,icon:J}))},Q=u.forwardRef(P),X={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M862 465.3h-81c-4.6 0-9 2-12.1 5.5L550 723.1V160c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v563.1L255.1 470.8c-3-3.5-7.4-5.5-12.1-5.5h-81c-6.8 0-10.5 8.1-6 13.2L487.9 861a31.96 31.96 0 0048.3 0L868 478.5c4.5-5.2.8-13.2-6-13.2z"}}]},name:"arrow-down",theme:"outlined"},Y=function(o,c){return u.createElement(h,g({},o,{ref:c,icon:X}))},Z=u.forwardRef(Y),ee={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M868 545.5L536.1 163a31.96 31.96 0 00-48.3 0L156 545.5a7.97 7.97 0 006 13.2h81c4.6 0 9-2 12.1-5.5L474 300.9V864c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V300.9l218.9 252.3c3 3.5 7.4 5.5 12.1 5.5h81c6.8 0 10.5-8 6-13.2z"}}]},name:"arrow-up",theme:"outlined"},te=function(o,c){return u.createElement(h,g({},o,{ref:c,icon:ee}))},re=u.forwardRef(te);function pe(){const{records:n,budgets:o}=H(),{employees:c,payrolls:$}=W(),{accounts:L}=_(),{receivables:j,payables:y}=K(),{taxRecords:E}=q(),v=n.filter(e=>e.type==="income").reduce((e,r)=>e+r.amount,0),S=n.filter(e=>e.type==="expense").reduce((e,r)=>e+r.amount,0),w=v-S,b=o.reduce((e,r)=>e+r.amount,0),I=o.reduce((e,r)=>{const l=n.filter(x=>x.type==="expense"&&x.category===r.category&&x.date.startsWith(r.month)).reduce((x,D)=>x+D.amount,0);return e+l},0),p=n.reduce((e,r)=>{const l=r.date.substring(0,7);return e[l]||(e[l]={income:0,expense:0}),r.type==="income"?e[l].income+=r.amount:e[l].expense+=r.amount,e},{}),m=Object.keys(p).sort().slice(-6),A=m.map(e=>{var r;return((r=p[e])==null?void 0:r.income)||0}),R=m.map(e=>{var r;return((r=p[e])==null?void 0:r.expense)||0}),V=n.filter(e=>e.type==="expense").reduce((e,r)=>(e[r.category]=(e[r.category]||0)+r.amount,e),{}),B={title:{text:"收支趋势",left:"center"},tooltip:{trigger:"axis",formatter:e=>e.map(r=>`${r.seriesName}: ¥${r.value.toLocaleString()}`).join("<br/>")},legend:{data:["收入","支出"],bottom:0},xAxis:{type:"category",data:m.length>0?m:["暂无数据"]},yAxis:{type:"value"},series:[{name:"收入",type:"line",smooth:!0,data:A.length>0?A:[0],itemStyle:{color:"#52c41a"}},{name:"支出",type:"line",smooth:!0,data:R.length>0?R:[0],itemStyle:{color:"#ff4d4f"}}]},M={title:{text:"支出分类",left:"center"},tooltip:{trigger:"item",formatter:"{b}: ¥{c} ({d}%)"},legend:{bottom:0},series:[{type:"pie",radius:["40%","70%"],data:Object.entries(V).map(([e,r])=>({name:e,value:r}))}]},N=o.map(e=>n.filter(r=>r.type==="expense"&&r.category===e.category&&r.date.startsWith(e.month)).reduce((r,l)=>r+l.amount,0)),C={title:{text:"预算执行情况",left:"center"},tooltip:{trigger:"axis"},xAxis:{type:"category",data:o.map(e=>e.category)},yAxis:{type:"value"},series:[{name:"预算",type:"bar",data:o.map(e=>e.amount),itemStyle:{color:"#1890ff"}},{name:"实际支出",type:"bar",data:N,itemStyle:{color:"#faad14"}}]};return t.jsxs("div",{children:[t.jsxs(d,{gutter:[16,16],children:[t.jsx(s,{xs:24,sm:12,lg:6,children:t.jsx(a,{children:t.jsx(i,{title:"总收入",value:v,precision:2,valueStyle:{color:"#3f8600"},prefix:t.jsx(re,{}),suffix:"元"})})}),t.jsx(s,{xs:24,sm:12,lg:6,children:t.jsx(a,{children:t.jsx(i,{title:"总支出",value:S,precision:2,valueStyle:{color:"#cf1322"},prefix:t.jsx(Z,{}),suffix:"元"})})}),t.jsx(s,{xs:24,sm:12,lg:6,children:t.jsx(a,{children:t.jsx(i,{title:"净利润",value:w,precision:2,valueStyle:{color:w>=0?"#3f8600":"#cf1322"},prefix:t.jsx(F,{}),suffix:"元"})})}),t.jsx(s,{xs:24,sm:12,lg:6,children:t.jsx(a,{children:t.jsx(i,{title:"预算使用率",value:(I/b*100).toFixed(1),precision:1,valueStyle:{color:I/b>.8?"#cf1322":"#1890ff"},prefix:t.jsx(T,{}),suffix:"%"})})})]}),t.jsxs(d,{gutter:[16,16],className:"mt-4",children:[t.jsx(s,{xs:24,lg:16,children:t.jsx(a,{children:t.jsx(f,{option:B,style:{height:300}})})}),t.jsx(s,{xs:24,lg:8,children:t.jsx(a,{children:t.jsx(f,{option:M,style:{height:300}})})})]}),t.jsxs(d,{gutter:[16,16],className:"mt-4",children:[t.jsx(s,{xs:24,lg:12,children:t.jsx(a,{children:t.jsx(f,{option:C,style:{height:300}})})}),t.jsx(s,{xs:24,lg:12,children:t.jsxs(a,{title:"财务健康指标",children:[t.jsxs(d,{gutter:16,children:[t.jsx(s,{span:12,children:t.jsx(i,{title:"银行总余额",value:L.reduce((e,r)=>e+r.balance,0),prefix:t.jsx(U,{}),precision:2,valueStyle:{color:"#1890ff"}})}),t.jsx(s,{span:12,children:t.jsx(i,{title:"员工数量",value:c.filter(e=>e.status==="active").length,prefix:t.jsx(k,{}),suffix:"人"})})]}),t.jsxs(d,{gutter:16,className:"mt-4",children:[t.jsx(s,{span:12,children:t.jsx(i,{title:"应收账款",value:j.reduce((e,r)=>e+(r.amount-r.paidAmount),0),prefix:"¥",precision:2,valueStyle:{color:"#fa8c16"}})}),t.jsx(s,{span:12,children:t.jsx(i,{title:"应付账款",value:y.reduce((e,r)=>e+(r.amount-r.paidAmount),0),prefix:"¥",precision:2,valueStyle:{color:"#cf1322"}})})]})]})})]}),t.jsxs(d,{gutter:[16,16],className:"mt-4",children:[t.jsx(s,{xs:24,lg:12,children:t.jsx(a,{title:t.jsxs(t.Fragment,{children:[t.jsx(Q,{className:"text-orange-500 mr-2"}),"待办提醒"]}),size:"small",children:t.jsx(z,{size:"small",dataSource:[{title:"待发放工资",count:$.filter(e=>e.status==="pending").length,color:"orange"},{title:"逾期应收款",count:j.filter(e=>e.status==="overdue").length,color:"red"},{title:"待申报税款",count:E.filter(e=>e.status==="pending").length,color:"blue"},{title:"即将到期应付",count:y.filter(e=>e.status==="pending").length,color:"orange"}],renderItem:e=>t.jsxs(z.Item,{children:[t.jsx("span",{children:e.title}),t.jsx(O,{color:e.color,children:e.count})]})})})}),t.jsx(s,{xs:24,lg:12,children:t.jsx(a,{title:"最近交易",size:"small",children:t.jsx(G,{size:"small",pagination:!1,dataSource:n.slice(-5).reverse(),rowKey:"id",columns:[{title:"日期",dataIndex:"date",width:100},{title:"类型",dataIndex:"type",width:80,render:e=>t.jsx(O,{color:e==="income"?"green":"red",children:e==="income"?"收入":"支出"})},{title:"描述",dataIndex:"description"},{title:"金额",dataIndex:"amount",render:e=>`¥${e.toLocaleString()}`}]})})})]})]})}export{pe as default};
