import{r as p,F as s,j as e,B as j,f as A,R as M,C as o,a as n,d as R,M as T,g as d,s as h,T as f,i as B}from"./index-DvYlsgoa.js";import{u as q}from"./bankStore-Br0JiNhk.js";import{S as u}from"./index-BHsiPuWj.js";import{F as y}from"./Table-7vnEQdqH.js";import{S as O}from"./index-Cew7-v5w.js";import{T as $}from"./index-CRZzFNA5.js";function _(){const{accounts:l,transactions:x,addAccount:b,updateAccount:I}=q(),[k,i]=p.useState(!1),[c,N]=p.useState(null),[r]=s.useForm(),g=l.reduce((t,a)=>t+a.balance,0),m=t=>{N(t||null),t?r.setFieldsValue(t):r.resetFields(),i(!0)},S=()=>{r.validateFields().then(t=>{c?(I(c.id,t),h.success("更新成功")):(b({...t,id:Date.now().toString(),balance:t.balance||0,status:"active"}),h.success("添加成功")),i(!1)})},v=t=>x.filter(a=>a.accountId===t).slice(0,5),w=[{title:"账户名称",dataIndex:"accountName",key:"accountName"},{title:"账号",dataIndex:"accountNo",key:"accountNo"},{title:"开户行",dataIndex:"bankName",key:"bankName"},{title:"账户类型",dataIndex:"type",key:"type",render:t=>({basic:"基本户",general:"一般户",special:"专用户"})[t]||t},{title:"余额",dataIndex:"balance",key:"balance",render:t=>e.jsxs("span",{className:"font-bold",children:["¥",t.toLocaleString()]})},{title:"状态",dataIndex:"status",key:"status",render:t=>e.jsx(f,{color:t==="active"?"green":"red",children:t==="active"?"正常":"冻结"})},{title:"操作",key:"action",render:(t,a)=>e.jsx(j,{icon:e.jsx(B,{}),size:"small",onClick:()=>m(a),children:"编辑"})}],C=[{title:"日期",dataIndex:"date",key:"date",width:100},{title:"类型",dataIndex:"type",key:"type",width:80,render:t=>{const a={income:"green",expense:"red",transfer:"blue"},F={income:"收入",expense:"支出",transfer:"转账"};return e.jsx(f,{color:a[t],children:F[t]})}},{title:"对方",dataIndex:"counterparty",key:"counterparty"},{title:"金额",dataIndex:"amount",key:"amount",render:(t,a)=>e.jsxs("span",{className:a.type==="income"?"text-green-600":"text-red-600",children:[a.type==="income"?"+":"-","¥",t.toLocaleString()]})},{title:"余额",dataIndex:"balance",key:"balance",render:t=>`¥${t.toLocaleString()}`},{title:"摘要",dataIndex:"description",key:"description"}];return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:"银行账户管理"}),e.jsx(j,{type:"primary",icon:e.jsx(A,{}),onClick:()=>m(),children:"添加账户"})]}),e.jsxs(M,{gutter:16,className:"mb-4",children:[e.jsx(o,{span:8,children:e.jsx(n,{children:e.jsx(u,{title:"账户总数",value:l.length,prefix:e.jsx(R,{})})})}),e.jsx(o,{span:8,children:e.jsx(n,{children:e.jsx(u,{title:"总余额",value:g,prefix:"¥",precision:2,valueStyle:{color:"#3f8600"}})})}),e.jsx(o,{span:8,children:e.jsx(n,{children:e.jsx(u,{title:"本月交易数",value:x.length})})})]}),e.jsx(n,{title:"账户列表",className:"mb-4",children:e.jsx(y,{columns:w,dataSource:l,rowKey:"id",pagination:!1})}),l.map(t=>e.jsx(n,{title:`${t.accountName} - 最近交易`,className:"mb-4",size:"small",children:e.jsx(y,{columns:C,dataSource:v(t.id),rowKey:"id",pagination:!1,size:"small"})},t.id)),e.jsx(T,{title:c?"编辑账户":"添加账户",open:k,onOk:S,onCancel:()=>i(!1),children:e.jsxs(s,{form:r,layout:"vertical",children:[e.jsx(s.Item,{name:"accountName",label:"账户名称",rules:[{required:!0}],children:e.jsx(d,{})}),e.jsx(s.Item,{name:"accountNo",label:"账号",rules:[{required:!0}],children:e.jsx(d,{})}),e.jsx(s.Item,{name:"bankName",label:"开户行",rules:[{required:!0}],children:e.jsx(d,{})}),e.jsx(s.Item,{name:"type",label:"账户类型",rules:[{required:!0}],children:e.jsx(O,{options:[{label:"基本户",value:"basic"},{label:"一般户",value:"general"},{label:"专用户",value:"special"}]})}),!c&&e.jsx(s.Item,{name:"balance",label:"初始余额",children:e.jsx($,{className:"w-full",prefix:"¥",precision:2})})]})})]})}export{_ as default};
