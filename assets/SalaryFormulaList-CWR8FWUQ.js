import{r as c,I as W,_ as K,F as a,j as e,B as m,f as G,R as d,C as r,a as x,M as S,g as T,E as f,T as u,s as w,S as J,z as Q,i as U,k as X}from"./index-Cc0-Jhr3.js";import{u as Y,c as Z}from"./salaryStore-DBpjMjYk.js";import{S as O}from"./index-BAFu33Px.js";import{F as ee}from"./Table-CWDNoC-e.js";import{S as F}from"./index-BlAgGAzq.js";import{T as t}from"./index-BFN91nfk.js";import{D as n}from"./index-BPzBcVnd.js";import{P as le}from"./index-4_QrhmQT.js";var se={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M251.2 387H320v68.8c0 1.8 1.8 3.2 4 3.2h48c2.2 0 4-1.4 4-3.3V387h68.8c1.8 0 3.2-1.8 3.2-4v-48c0-2.2-1.4-4-3.3-4H376v-68.8c0-1.8-1.8-3.2-4-3.2h-48c-2.2 0-4 1.4-4 3.2V331h-68.8c-1.8 0-3.2 1.8-3.2 4v48c0 2.2 1.4 4 3.2 4zm328 0h193.6c1.8 0 3.2-1.8 3.2-4v-48c0-2.2-1.4-4-3.3-4H579.2c-1.8 0-3.2 1.8-3.2 4v48c0 2.2 1.4 4 3.2 4zm0 265h193.6c1.8 0 3.2-1.8 3.2-4v-48c0-2.2-1.4-4-3.3-4H579.2c-1.8 0-3.2 1.8-3.2 4v48c0 2.2 1.4 4 3.2 4zm0 104h193.6c1.8 0 3.2-1.8 3.2-4v-48c0-2.2-1.4-4-3.3-4H579.2c-1.8 0-3.2 1.8-3.2 4v48c0 2.2 1.4 4 3.2 4zm-195.7-81l61.2-74.9c4.3-5.2.7-13.1-5.9-13.1H388c-2.3 0-4.5 1-5.9 2.9l-34 41.6-34-41.6a7.85 7.85 0 00-5.9-2.9h-50.9c-6.6 0-10.2 7.9-5.9 13.1l61.2 74.9-62.7 76.8c-4.4 5.2-.8 13.1 5.8 13.1h50.8c2.3 0 4.5-1 5.9-2.9l35.5-43.5 35.5 43.5c1.5 1.8 3.7 2.9 5.9 2.9h50.8c6.6 0 10.2-7.9 5.9-13.1L383.5 675zM880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-36 732H180V180h664v664z"}}]},name:"calculator",theme:"outlined"},ae=function(b,y){return c.createElement(W,K({},b,{ref:y,icon:se}))},ie=c.forwardRef(ae);const N=[{value:"fixed",label:"固定月薪",color:"blue"},{value:"hourly",label:"计时工资",color:"green"},{value:"piece",label:"计件工资",color:"orange"},{value:"commission",label:"销售提成",color:"purple"},{value:"mixed",label:"混合制",color:"cyan"}];function ue(){const{salaryFormulas:h,addSalaryFormula:b,updateSalaryFormula:y,deleteSalaryFormula:H}=Y(),[L,v]=c.useState(!1),[A,V]=c.useState(!1),[$,z]=c.useState(!1),[s,I]=c.useState(null),[j,C]=c.useState(null),[o]=a.useForm(),[g]=a.useForm(),k=l=>{I(l||null),l?o.setFieldsValue(l):(o.resetFields(),o.setFieldsValue({type:"fixed",isActive:!0,socialInsuranceRate:10,housingFundRate:8,overtimeRate:1.5,commissionRates:[],performanceRatios:[{level:"A",ratio:1.2},{level:"B",ratio:1},{level:"C",ratio:.8}]})),v(!0)},M=l=>{I(l),V(!0)},B=l=>{I(l),g.resetFields(),C(null),z(!0)},D=()=>{s&&g.validateFields().then(l=>{const i=Z(s,l);C(i)})},E=()=>{o.validateFields().then(l=>{const i={...l,id:(s==null?void 0:s.id)||Date.now().toString(),commissionRates:l.commissionRates||[],performanceRatios:l.performanceRatios||[]};s?(y(s.id,i),w.success("更新成功")):(b(i),w.success("创建成功")),v(!1)})},_=l=>{H(l),w.success("删除成功")},R=l=>{const i=N.find(P=>P.value===l);return i?e.jsx(u,{color:i.color,children:i.label}):e.jsx(u,{children:l})},q=[{title:"公式名称",dataIndex:"name",key:"name"},{title:"类型",dataIndex:"type",key:"type",render:l=>R(l)},{title:"描述",dataIndex:"description",key:"description",width:250},{title:"基本工资",dataIndex:"baseSalary",key:"baseSalary",render:l=>l>0?`¥${l.toLocaleString()}`:"-"},{title:"社保比例",dataIndex:"socialInsuranceRate",key:"socialInsuranceRate",render:l=>`${l}%`},{title:"状态",dataIndex:"isActive",key:"isActive",render:l=>e.jsx(u,{color:l?"green":"default",children:l?"启用":"停用"})},{title:"操作",key:"action",width:220,render:(l,i)=>e.jsxs(J,{children:[e.jsx(m,{icon:e.jsx(Q,{}),size:"small",onClick:()=>M(i),children:"详情"}),e.jsx(m,{icon:e.jsx(ie,{}),size:"small",onClick:()=>B(i),children:"测试"}),e.jsx(m,{icon:e.jsx(U,{}),size:"small",onClick:()=>k(i),children:"编辑"}),e.jsx(le,{title:"确定删除?",onConfirm:()=>_(i.id),children:e.jsx(m,{icon:e.jsx(X,{}),size:"small",danger:!0,children:"删除"})})]})}],p=a.useWatch("type",o);return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:"工资公式管理"}),e.jsx(m,{type:"primary",icon:e.jsx(G,{}),onClick:()=>k(),children:"新建公式"})]}),e.jsxs(d,{gutter:16,className:"mb-4",children:[N.map(l=>e.jsx(r,{span:4,children:e.jsx(x,{size:"small",children:e.jsx(O,{title:l.label,value:h.filter(i=>i.type===l.value).length,suffix:"个"})})},l.value)),e.jsx(r,{span:4,children:e.jsx(x,{size:"small",children:e.jsx(O,{title:"总计",value:h.length,suffix:"个",valueStyle:{color:"#1890ff"}})})})]}),e.jsx(x,{children:e.jsx(ee,{columns:q,dataSource:h,rowKey:"id"})}),e.jsx(S,{title:s?"编辑工资公式":"新建工资公式",open:L,onOk:E,onCancel:()=>v(!1),width:700,children:e.jsxs(a,{form:o,layout:"vertical",children:[e.jsxs(d,{gutter:16,children:[e.jsx(r,{span:12,children:e.jsx(a.Item,{name:"name",label:"公式名称",rules:[{required:!0}],children:e.jsx(T,{placeholder:"如：技术岗绩效制"})})}),e.jsx(r,{span:12,children:e.jsx(a.Item,{name:"type",label:"计算类型",rules:[{required:!0}],children:e.jsx(F,{options:N.map(l=>({label:l.label,value:l.value}))})})})]}),e.jsx(a.Item,{name:"description",label:"描述",children:e.jsx(T.TextArea,{rows:2,placeholder:"适用场景说明"})}),e.jsx(f,{children:"薪资配置"}),e.jsxs(d,{gutter:16,children:[e.jsx(r,{span:8,children:e.jsx(a.Item,{name:"baseSalary",label:"基本工资",initialValue:0,children:e.jsx(t,{className:"w-full",min:0,prefix:"¥"})})}),e.jsx(r,{span:8,children:e.jsx(a.Item,{name:"positionAllowance",label:"岗位津贴",initialValue:0,children:e.jsx(t,{className:"w-full",min:0,prefix:"¥"})})}),e.jsx(r,{span:8,children:e.jsx(a.Item,{name:"isActive",label:"状态",initialValue:!0,children:e.jsx(F,{options:[{label:"启用",value:!0},{label:"停用",value:!1}]})})})]}),(p==="hourly"||p==="mixed")&&e.jsxs(d,{gutter:16,children:[e.jsx(r,{span:8,children:e.jsx(a.Item,{name:"hourlyRate",label:"时薪",initialValue:0,children:e.jsx(t,{className:"w-full",min:0,prefix:"¥",suffix:"/小时"})})}),e.jsx(r,{span:8,children:e.jsx(a.Item,{name:"overtimeRate",label:"加班倍率",initialValue:1.5,children:e.jsx(t,{className:"w-full",min:1,max:3,step:.5})})})]}),p==="piece"&&e.jsx(a.Item,{name:"pieceRate",label:"计件单价",initialValue:0,children:e.jsx(t,{className:"w-full",min:0,prefix:"¥",suffix:"/件"})}),p==="commission"&&e.jsx(a.Item,{name:"commissionBase",label:"提成底薪",initialValue:0,children:e.jsx(t,{className:"w-full",min:0,prefix:"¥"})}),e.jsx(f,{children:"扣款配置"}),e.jsxs(d,{gutter:16,children:[e.jsx(r,{span:12,children:e.jsx(a.Item,{name:"socialInsuranceRate",label:"社保比例(%)",initialValue:10,children:e.jsx(t,{className:"w-full",min:0,max:30,suffix:"%"})})}),e.jsx(r,{span:12,children:e.jsx(a.Item,{name:"housingFundRate",label:"公积金比例(%)",initialValue:8,children:e.jsx(t,{className:"w-full",min:0,max:20,suffix:"%"})})})]})]})}),e.jsx(S,{title:"公式详情",open:A,onCancel:()=>V(!1),footer:null,width:600,children:s&&e.jsxs(n,{bordered:!0,column:2,size:"small",children:[e.jsx(n.Item,{label:"公式名称",children:s.name}),e.jsx(n.Item,{label:"类型",children:R(s.type)}),e.jsx(n.Item,{label:"描述",span:2,children:s.description}),e.jsxs(n.Item,{label:"基本工资",children:["¥",s.baseSalary.toLocaleString()]}),e.jsxs(n.Item,{label:"岗位津贴",children:["¥",s.positionAllowance.toLocaleString()]}),s.hourlyRate>0&&e.jsxs(n.Item,{label:"时薪",children:["¥",s.hourlyRate,"/小时"]}),s.pieceRate>0&&e.jsxs(n.Item,{label:"计件单价",children:["¥",s.pieceRate,"/件"]}),s.commissionBase>0&&e.jsxs(n.Item,{label:"提成底薪",children:["¥",s.commissionBase]}),e.jsxs(n.Item,{label:"社保比例",children:[s.socialInsuranceRate,"%"]}),e.jsxs(n.Item,{label:"公积金比例",children:[s.housingFundRate,"%"]}),s.commissionRates.length>0&&e.jsx(n.Item,{label:"提成阶梯",span:2,children:s.commissionRates.map((l,i)=>e.jsxs(u,{children:["¥",l.min.toLocaleString(),"-",l.max.toLocaleString(),": ",l.rate,"%"]},i))}),s.performanceRatios.length>0&&e.jsx(n.Item,{label:"绩效系数",span:2,children:s.performanceRatios.map((l,i)=>e.jsxs(u,{children:[l.level,": ×",l.ratio]},i))})]})}),e.jsx(S,{title:"工资计算测试",open:$,onCancel:()=>z(!1),footer:null,width:500,children:s&&e.jsxs(e.Fragment,{children:[e.jsxs(x,{size:"small",className:"mb-4",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"公式："}),s.name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"类型："}),R(s.type)]})]}),e.jsxs(a,{form:g,layout:"vertical",children:[s.type==="hourly"&&e.jsxs(e.Fragment,{children:[e.jsx(a.Item,{name:"hoursWorked",label:"工作小时数",initialValue:176,children:e.jsx(t,{className:"w-full",min:0})}),e.jsx(a.Item,{name:"overtimeHours",label:"加班小时数",initialValue:0,children:e.jsx(t,{className:"w-full",min:0})})]}),s.type==="piece"&&e.jsx(a.Item,{name:"piecesCompleted",label:"完成件数",initialValue:0,children:e.jsx(t,{className:"w-full",min:0})}),s.type==="commission"&&e.jsx(a.Item,{name:"salesAmount",label:"销售额",initialValue:0,children:e.jsx(t,{className:"w-full",min:0,prefix:"¥"})}),(s.type==="fixed"||s.type==="mixed")&&e.jsx(a.Item,{name:"performanceLevel",label:"绩效等级",children:e.jsx(F,{options:s.performanceRatios.map(l=>({label:`${l.level}级 (×${l.ratio})`,value:l.level}))})}),s.type==="mixed"&&e.jsx(a.Item,{name:"overtimeHours",label:"加班小时数",initialValue:0,children:e.jsx(t,{className:"w-full",min:0})}),e.jsx(m,{type:"primary",onClick:D,block:!0,children:"计算"})]}),j&&e.jsxs(x,{size:"small",className:"mt-4",title:"计算结果",children:[e.jsx("p",{className:"text-gray-500",children:j.description}),e.jsx(f,{}),Object.entries(j.details).map(([l,i])=>e.jsxs("div",{className:"flex justify-between py-1",children:[e.jsx("span",{children:l}),e.jsxs("span",{children:["¥",i.toLocaleString()]})]},l)),e.jsx(f,{}),e.jsxs("div",{className:"flex justify-between font-bold text-lg",children:[e.jsx("span",{children:"应发合计"}),e.jsxs("span",{className:"text-green-600",children:["¥",j.grossSalary.toLocaleString()]})]})]})]})})]})}export{ue as default};
