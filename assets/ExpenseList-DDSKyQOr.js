import{u as C,r as d,j as t,S as l,B as r,f as v,g as R,h as k,T as Y,i as b,k as D,s as E}from"./index-B1irlVr5.js";import{d as s}from"./dayjs.min-CuWnGRVX.js";import{u as M}from"./financeStore-Cx6ve21G.js";import{I as T,E as $}from"./ImportButton-C6aQV5P-.js";import{S as B}from"./index-CouCZRz8.js";import{F}from"./Table-WxZSygbk.js";import{P as N}from"./index-CsXvx_N-.js";import"./export-cwhyOQjn.js";const w=["办公费用","人力成本","营销费用","差旅费","其他支出"];function H(){const i=C(),{records:x,deleteRecord:m,addRecord:p}=M(),u=x.filter(e=>e.type==="expense"),[n,f]=d.useState(""),[o,h]=d.useState(),c=u.filter(e=>{const a=e.description.includes(n)||e.category.includes(n),S=!o||e.category===o;return a&&S}),j=e=>{e.forEach(a=>{a.金额&&a.类别&&p({id:Date.now().toString()+Math.random(),type:"expense",amount:parseFloat(a.金额)||0,category:a.类别||"其他支出",description:a.描述||"",date:a.日期||s().format("YYYY-MM-DD"),createdAt:s().format("YYYY-MM-DD")})})},y=[{title:"日期",dataIndex:"date"},{title:"类别",dataIndex:"category"},{title:"描述",dataIndex:"description"},{title:"金额",dataIndex:"amount",render:e=>String(e)}],g=e=>{m(e),E.success("删除成功")},I=[{title:"日期",dataIndex:"date",key:"date",sorter:(e,a)=>s(e.date).unix()-s(a.date).unix()},{title:"类别",dataIndex:"category",key:"category",render:e=>t.jsx(Y,{color:"red",children:e})},{title:"描述",dataIndex:"description",key:"description"},{title:"金额",dataIndex:"amount",key:"amount",render:e=>`¥${e.toLocaleString()}`,sorter:(e,a)=>e.amount-a.amount},{title:"操作",key:"action",render:(e,a)=>t.jsxs(l,{children:[t.jsx(r,{icon:t.jsx(b,{}),size:"small",onClick:()=>i(`/expense/edit/${a.id}`),children:"编辑"}),t.jsx(N,{title:"确定删除？",onConfirm:()=>g(a.id),children:t.jsx(r,{icon:t.jsx(D,{}),size:"small",danger:!0,children:"删除"})})]})}];return t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between items-center mb-4",children:[t.jsx("h2",{className:"text-xl font-bold",children:"支出管理"}),t.jsxs(l,{children:[t.jsx(T,{onImport:j}),t.jsx($,{data:c,columns:y,filename:"支出记录"}),t.jsx(r,{type:"primary",icon:t.jsx(v,{}),onClick:()=>i("/expense/create"),children:"新增支出"})]})]}),t.jsxs("div",{className:"flex gap-4 mb-4",children:[t.jsx(R,{placeholder:"搜索描述或类别",prefix:t.jsx(k,{}),value:n,onChange:e=>f(e.target.value),style:{width:250}}),t.jsx(B,{placeholder:"选择类别",allowClear:!0,style:{width:150},value:o,onChange:h,options:w.map(e=>({label:e,value:e}))})]}),t.jsx(F,{columns:I,dataSource:c,rowKey:"id"})]})}export{H as default};
