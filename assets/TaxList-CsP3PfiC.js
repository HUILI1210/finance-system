import{r as F,F as s,j as t,B as o,f as Y,R as q,C as c,a as n,T as x,M as $,g as y,s as u,A as L}from"./index-DvYlsgoa.js";import{d as m}from"./dayjs.min-BfZd7ylZ.js";import{u as z}from"./invoiceStore-DR7B55lf.js";import{S as p}from"./index-BHsiPuWj.js";import{F as g}from"./Table-7vnEQdqH.js";import{S as O}from"./index-Cew7-v5w.js";import{T as I}from"./index-CRZzFNA5.js";import{D as B}from"./index-BQmgfC5F.js";function U(){const{taxRecords:r,addTaxRecord:b,updateTaxRecord:j}=z(),[D,d]=F.useState(!1),[i]=s.useForm(),T=r.filter(e=>e.status==="pending").reduce((e,a)=>e+a.taxAmount,0),S=r.filter(e=>e.status==="declared").reduce((e,a)=>e+a.taxAmount,0),k=r.filter(e=>e.status==="paid").reduce((e,a)=>e+a.taxAmount,0),v=()=>{i.resetFields(),d(!0)},A=()=>{i.validateFields().then(e=>{const a=e.taxableAmount*(e.taxRate/100);b({...e,id:Date.now().toString(),taxAmount:Math.round(a*100)/100,dueDate:e.dueDate.format("YYYY-MM-DD"),status:"pending"}),u.success("添加成功"),d(!1)})},N=e=>{j(e,{status:"declared"}),u.success("已申报")},R=e=>{j(e,{status:"paid",paidDate:m().format("YYYY-MM-DD")}),u.success("已缴纳")},f=e=>({pending:"orange",declared:"blue",paid:"green"})[e]||"default",h=e=>({pending:"待申报",declared:"已申报",paid:"已缴纳"})[e]||e,w=e=>({vat:"增值税",corporate:"企业所得税",personal:"个人所得税",stamp:"印花税"})[e]||e,M=[{title:"税种",dataIndex:"taxType",key:"taxType",render:e=>w(e)},{title:"税目",dataIndex:"taxName",key:"taxName"},{title:"所属期",dataIndex:"period",key:"period"},{title:"计税依据",dataIndex:"taxableAmount",key:"taxableAmount",render:e=>`¥${e.toLocaleString()}`},{title:"税率",dataIndex:"taxRate",key:"taxRate",render:e=>`${e}%`},{title:"应纳税额",dataIndex:"taxAmount",key:"taxAmount",render:e=>t.jsxs("span",{className:"font-bold text-red-600",children:["¥",e.toLocaleString()]})},{title:"申报截止",dataIndex:"dueDate",key:"dueDate"},{title:"状态",dataIndex:"status",key:"status",render:e=>t.jsx(x,{color:f(e),children:h(e)})},{title:"操作",key:"action",render:(e,a)=>t.jsxs(t.Fragment,{children:[a.status==="pending"&&t.jsx(o,{size:"small",onClick:()=>N(a.id),children:"申报"}),a.status==="declared"&&t.jsx(o,{size:"small",type:"primary",icon:t.jsx(L,{}),onClick:()=>R(a.id),children:"缴纳"})]})}],C=r.filter(e=>e.status!=="paid").sort((e,a)=>new Date(e.dueDate).getTime()-new Date(a.dueDate).getTime()).slice(0,5);return t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between items-center mb-4",children:[t.jsx("h2",{className:"text-xl font-bold",children:"税务管理"}),t.jsx(o,{type:"primary",icon:t.jsx(Y,{}),onClick:v,children:"添加税务记录"})]}),t.jsxs(q,{gutter:16,className:"mb-4",children:[t.jsx(c,{span:8,children:t.jsx(n,{children:t.jsx(p,{title:"待申报税额",value:T,prefix:"¥",precision:2,valueStyle:{color:"#fa8c16"}})})}),t.jsx(c,{span:8,children:t.jsx(n,{children:t.jsx(p,{title:"已申报待缴",value:S,prefix:"¥",precision:2,valueStyle:{color:"#1890ff"}})})}),t.jsx(c,{span:8,children:t.jsx(n,{children:t.jsx(p,{title:"本年已缴税款",value:k,prefix:"¥",precision:2,valueStyle:{color:"#3f8600"}})})})]}),t.jsx(n,{title:"税务日历",className:"mb-4",children:t.jsx(g,{columns:[{title:"税种",dataIndex:"taxName"},{title:"所属期",dataIndex:"period"},{title:"应纳税额",dataIndex:"taxAmount",render:e=>`¥${e.toLocaleString()}`},{title:"截止日期",dataIndex:"dueDate"},{title:"剩余天数",render:(e,a)=>{const l=m(a.dueDate).diff(m(),"day");return t.jsx(x,{color:l<0?"red":l<7?"orange":"green",children:l<0?`逾期${-l}天`:`${l}天`})}},{title:"状态",dataIndex:"status",render:e=>t.jsx(x,{color:f(e),children:h(e)})}],dataSource:C,rowKey:"id",pagination:!1,size:"small"})}),t.jsx(n,{title:"税务明细",children:t.jsx(g,{columns:M,dataSource:r,rowKey:"id"})}),t.jsx($,{title:"添加税务记录",open:D,onOk:A,onCancel:()=>d(!1),children:t.jsxs(s,{form:i,layout:"vertical",children:[t.jsx(s.Item,{name:"taxType",label:"税种",rules:[{required:!0}],children:t.jsx(O,{options:[{label:"增值税",value:"vat"},{label:"企业所得税",value:"corporate"},{label:"个人所得税",value:"personal"},{label:"印花税",value:"stamp"}]})}),t.jsx(s.Item,{name:"taxName",label:"税目",rules:[{required:!0}],children:t.jsx(y,{})}),t.jsx(s.Item,{name:"period",label:"所属期",rules:[{required:!0}],children:t.jsx(y,{placeholder:"如：2024-01 或 2024-Q1"})}),t.jsx(s.Item,{name:"taxableAmount",label:"计税依据",rules:[{required:!0}],children:t.jsx(I,{className:"w-full",prefix:"¥",precision:2})}),t.jsx(s.Item,{name:"taxRate",label:"税率(%)",rules:[{required:!0}],children:t.jsx(I,{className:"w-full",suffix:"%",precision:2})}),t.jsx(s.Item,{name:"dueDate",label:"申报截止日",rules:[{required:!0}],children:t.jsx(B,{className:"w-full"})})]})})]})}export{U as default};
